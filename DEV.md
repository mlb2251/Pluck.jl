# Structure of Pluck.jl
- `USAGE.md` a guide to Pluck usage – start here for writing programs in Pluck
- `programs/` This directory contains example Pluck programs. See `USAGE.md` for a guide to the format and how to enable syntax highlighting.
- `src/`
    - `Pluck.jl`
    - `language/` 
        - `define.jl` Macros for programmatically defining Pluck expressions.
        - `definitions.jl` Defines commonly used Pluck functions through a legacy macro approach; similar to `stdlib.pluck`, but the latter should generally be preferred for adding new definitions.
        - `discrete.jl` Defines `discrete()` which allows for constructing categorical distributions in Pluck
        - `grammar.jl` Grammar utilities for randomly sampling Pluck expressions
        - `pexpr.jl` Pluck expression type, Pluck builtins, parsing, and basic functions over expressions.
        - `primitives.jl` User-added primitives that don't need the capabilities of builtins. Modifications to Pluck to support new expression forms that can't be modelled through definitions can be added either here or in `pexpr.jl`.
        - `stdlib.pluck` Prelude of widely used Pluck functions.
        - `subexprs.jl` Utilities for traversing Pluck expressions, largely used in context of sampling expressions.
        - `toplevel.jl` Handles the `.pluck` format for writing Pluck code, described in `USAGE.md`. Parses Pluck definitions and queries and executes the appropriate backend functions.
        - `types.jl` Utilities for parsing and defining new algebraic data types in Pluck.
        - `values.jl` Where Values and Closures are defined, as well as utilities for converting to and from Julia values and Pluck values.
    - `likelihood/`
        - `addresses.jl` Functions for checking which randomness addresses might be used by an expression, to support optimizations – not used in the current implementation.
        - `bdd.jl` Core algorithm of lazy knowledge compilation, the default mode of Pluck evaluation. This is the key file to look at for trying out new approaches to likelihood evaluation.
        - `bdd_eager.jl` Similar to `bdd.jl` but does *strict* knowledge compilation.
        - `bdd_suspend.jl` Implementation of Lazy Programmable Subproblem Monte Carlo (LPSMC), our approach to approximate inference.
        - `bdd_viz.jl` Utilities functions for helping to visualize BDDs generated by `bdd.jl`.
        - `lazy_enumerator.jl` An implementation of lazy enumeration as a baseline. Also supports strict enumeration.
        - `posterior_sample.jl` Support for posterior sampling queries in Pluck.
        - `sample_value.jl` Support for sampling entire values for a Pluck expression.
        - `bdd_slow.jl` (unused) An earlier implementation of `bdd.jl`
        - `hash_spn.jl` (unused) An implementation of sum-product networks as an alternative to BDDs. Used by `spe.jl`.
        - `spe.jl` (unused) A sum-product network version of lazy knowledge compilation, using `hash_spn.jl` as the implementation of SPNs.
        - `stack_machine.jl` (unused) An experimental non-recursive version of `spe.jl`
    - `search/`
        - `tasks.jl` Utitilies for loading benchmarks from files.
    - `util/`
        - `html.jl` Utilities for visualizing results in HTML.
        - `util.jl` Assorted utilities for timing and likelihood computation.
    - `RSDD/`
        - `RSDD.jl` Julia bindings for the `rsdd` Rust backend to handle BDDs. This is where you can add new bindings to handle custom BDD operations.
        - `rsdd` Submodule for [our fork](https://github.com/alex-lew/rsdd.git) of the [rsdd](https://github.com/neuppl/rsdd) library for manipulating BDDs.
